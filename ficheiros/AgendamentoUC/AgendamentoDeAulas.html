<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Horário ISCTE</title>
    <link rel="stylesheet" type="text/css" href="estilos.css">
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>
</head>

<body>
    <h1>Agendamento de Aulas:</h1>

    <!-- Formulário para solicitar 3 inputs -->
    <form id="userInputForm">

        <div class="input-container">
            <label for="UC">Nome da UC:</label>
            <input type="text" id="UC" name="UC" required><br><br>
        </div>
        
        <div class="input-container">
            <label for="Licenciatura">Nome da Licenciatura:</label>
            <input type="text" id="Licenciatura" name="Licenciatura" required><br><br>
        </div>
        
        <br>
        <div class="input-container">
        <label for="nmrAulas">Número de aulas:</label>
        <input type="number" id="nmrAulas" name="nmrAulas" max="40" min ="1" required><br><br>
        </div>

        <div class="input-container">
        <label for="nmrAlunos">Número máximo de alunos:</label>
        <input type="number" id="nmrAlunos" name="nmrAlunos"><br><br>
        </div>

        <div class="input-container">
        <label for="semanaSemestre">Semana do semestre a começar a UC:</label>
        <input type="number" id="semanaSemestre" name="semanaSemestre"><br><br>
        </div>

        <br>
        <label for="input4">Períodos em que é <strong>possível</strong> alocar as aulas:</label><br>
        <input type="checkbox" id="manha" name="periodoPossivel" value="8-12.30">
        <label for="manha">Manhã (8:00 - 12:30)</label><br>
        <input type="checkbox" id="tarde" name="periodoPossivel" value="12.30-18.30">
        <label for="tarde">Tarde (12:30 - 18:30)</label><br>
        <input type="checkbox" id="noite" name="periodoPossivel" value="18.30-23">
        <label for="noite">Noite (18:30 - 23:00)</label><br><br>


        <label for="input5">Preferência de dias da semana:</label><br>
        <input type="checkbox" value="Seg" name="diaDaSemanaPref" id="Segunda-feira">
        <label for="segunda">Segunda-feira</label><br>
        <input type="checkbox" value="Ter" name="diaDaSemanaPref" id="Terça-feira">
        <label for="terca">Terça-feira</label><br>
        <input type="checkbox" value="Qua" name="diaDaSemanaPref" id="Quarta-feira">
        <label for="quarta">Quarta-feira</label><br>
        <input type="checkbox" value="Qui" name="diaDaSemanaPref" id="Quinta-feira">
        <label for="quinta">Quinta-feira</label><br>
        <input type="checkbox" value="Sex" name="diaDaSemanaPref" id="Sexta-feira">
        <label for="sexta">Sexta-feira</label><br>
        <input type="checkbox" value="Sab" name="diaDaSemanaPref" id="Sábado">
        <label for="sabado">Sábado</label><br>


        <div class="form-group">
            <p class="label_input">Preferência de sala</p>
            <div id="preferencias-container">
                <p>Preferência nº1:</p>
                <select class="form-select" id="preferenciaSala1" aria-label="Default select example">
                    <option selected>Escolha uma Preferência</option>
                </select>
            </div>
            <button type="button" class="btn btn-secondary" id="addPreferenceBtn">Adicionar Preferência</button>
            
        </div>

        </div><br>

        <div class="form-group">
            <p>Salas Inaceitáveis:</p>
            <select class="form-select" id='salasInaceitaveis' name="salasInaceitaveis[]"
                aria-label="Default select example" multiple>
            </select>
        </div><br>

        

        <input type="submit" value="Submit">
    </form>

    <script type="text/javascript">
        const pathJsonSalas = 'CaracterizacaoDasSalas.json';
        fetch(pathJsonSalas)
            .then(response => {
                // Verificar se o request foi bem sucedido
                if (!response.ok) {
                    throw new Error(`Failed to fetch ${pathJsonSalas}: ${response.statusText}`);
                }

                // Parse the JSON data
                return response.json();
            })

            .then(data => {

                const salas = data;

                // Obter todas as salas
                const nomesSalas = salas.map(room => room['Nome sala']);

                const preferenciaSala = document.getElementById('preferenciaSala');


                const salasInaceitaveis = document.getElementById('salasInaceitaveis');

                nomesSalas.forEach(nomeSala => {
                    const optionPreferencia1 = document.createElement('option');
                    optionPreferencia1.textContent = nomeSala;
                    preferenciaSala.appendChild(optionPreferencia1);

                    const optionSalasInaceitaveis = document.createElement('option');
                    optionSalasInaceitaveis.textContent = nomeSala;
                    salasInaceitaveis.appendChild(optionSalasInaceitaveis);
                });
                
                let preferenceCount = 1;
        let inaceitavelCount = 1;

        addButton.addEventListener('click', function () {
            preferenceCount++;

            // Adiciona um novo input para as salas preferidas
            const preferenceDiv = document.createElement('div');
            preferenceDiv.classList.add('form-group');
            preferenceDiv.innerHTML = `
                <p>Preferência nº${preferenceCount}:</p>
                <select class="form-select" id="preferenciaSala${preferenceCount}" aria-label="Default select example">
                    <option selected>Escolha uma Preferência</option>
                </select>
            `;

            preferencesContainer.appendChild(preferenceDiv);

            const novaPref = document.getElementById(`preferenciaSala${preferenceCount}`);
        })

            })
            .catch(error => {
                console.error(`Error loading ${pathJsonSalas}:`, error);
            });
    </script>

    <script src="form.js"></script>

</body>

</html>