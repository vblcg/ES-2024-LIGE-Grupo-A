<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Horário ISCTE</title>
    <script src="luxon.js"></script>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>
</head>

<body>
    <script type="text/javascript">
        var table; // Declarar a variável da tabela

        /**
         * Esconder e Mostrar colunas
         * @param {string} columnName - Nome da coluna
        */
        function toggleColumn(columnName) {
            var column = table.getColumn(columnName);
            var selected = false;
            if (column) {
                column.toggle();
                adjustTableWidth();
            }
        }
    </script>

    <h1>Calendário de aulas:</h1>
    <div id="toggle-buttons">
        <a>Esconder/mostrar colunas:</a>
        <a class="link" href="##" id="Curso" onclick="toggleColumn('Curso')">Curso,</a>
        <a class="link" href="##" id="UC" onclick="toggleColumn('UC')"> UC,</a>
        <a class="link" href="##" id="SalaAtribuida" onclick="toggleColumn('Sala atribuida a aula')"> Sala atribuida a aula</a>
        <br><br>
    </div>
    <div id="table-horario">
        <script type="text/javascript">
            const pathJson = 'http://localhost/Horário.json';

            /** 
             * Lê os dados do ficheiro json e cria uma tabela do tabulator com os mesmos
             */
            fetch(pathJson)
                .then(response => {
                    // Check if the request was successful
                    if (!response.ok) {
                        throw new Error(`Failed to fetch ${pathJson}: ${response.statusText}`);
                    }

                    // Parse the JSON data
                    return response.json();
                })

                .then(data => {
                    // 'data' is now an array containing the parsed JSON content

                    table = new Tabulator("#table-horario", {
                        height: "700px",
                        layout: "fitDataTable",
                        pagination: "local",
                        resizableRows: true,
                        movableColumns: true,
                        data: data,
                        columns: [
                            { title: "Curso", field: "Curso", headerFilter: "input" },
                            { title: "UC", field: "UC", headerFilter: "input" },
                            { title: "Sala atribuida a aula", field: "Sala atribuida a aula", headerFilter: "input" }
                        ],
                    });
                })
                .catch(error => {
                    console.error(`Error loading ${pathJson}:`, error);
                });
        </script>
    </div>
    <style>
        .link {
            font-weight: normal;
            color: darkblue;
            text-decoration: none;
        }
    </style>
</body>

</html>
